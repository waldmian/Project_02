import random
import os
import sys
separator = '-' * 40

def secret_number():
    return str(random.randint(1000, 9999))

def user_guess(): 
  return str(input(f"Enter a 4-digit number: \n{separator}\n>>> "))

def calculate_bulls(secret_number, guess):
    """Calculates the number of bulls for user's guess."""
    bulls = 0
    #secret_digits = list(secret_number)
    for i in range(4):
        if guess[i] == secret_number[i]:
            bulls += 1
            #secret_digits.remove(guess[i])
    return bulls

def calculate_cows(secret_number, guess):
    """Calculates the number of cows for user's guess."""
    cows = 0
    secret_digits = list(secret_number)
    guessed_digits = list(guess)
    for i in range(4):
        if guess[i] == secret_number[i]:
            secret_digits.remove(guess[i])
            guessed_digits.remove(guess[i])
    for j in guessed_digits:
        if j in secret_digits:
            cows += 1
            secret_digits.remove(j)
    return cows
    # for i in range(4):
    #     if guess[i] in secret_digits and guess[i] != secret_number[i]:
    #         cows += 1
    #         secret_digits.remove(guess[i])
    # return cows

def print_results(bulls, cows):
    """Prints the results of user's guess."""
    bulls_text = "bull" if bulls == 1 else "bulls"
    cows_text = "cow" if cows == 1 else "cows"
    print(f"{bulls} {bulls_text}, {cows} {cows_text}")


def all_game():
    separator = '-' * 40
    game_on = True
    number = secret_number()
    print(f"[DEBUG] Secret number is: {number}")
    attempts = 0
    
    while game_on:
        guessing = user_guess()
        #secret_digits = list(number)
        if guessing.lower() == "q":
            print('quitting the game')
            sys.exit()
        elif len(guessing) != 4 or not guessing.isdigit():
            os.system('cls')
            print("Invalid input. Please enter a 4-digit number", 
             "(or press 'q' to quit).")
            continue
        attempts += 1

        print(separator)
        bulls = calculate_bulls(number, guessing)
        cows = calculate_cows(number, guessing)

        nr_bulls = bulls
        nr_cows = cows

        print_results(nr_bulls, nr_cows)
        # bulls_text = "bull" if nr_bulls == 1 else "bulls"
        # cows_text = "cow" if nr_cows == 1 else "cows"
        # print(f"{nr_bulls} {bulls_text}, {nr_cows} {cows_text}")

        if nr_bulls == 4:
            attempts_text = "attempt" if attempts == 1 else "attempts"
            print(f"Congratulations! You guessed the right number in {attempts} {attempts_text}!")
            break

all_game()